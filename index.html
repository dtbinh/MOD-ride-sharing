 <!--   authors: Chris Wong
        license: MIT
 -->

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>On-Demand High-Capacity Ride-Sharing</title>
    

    <script src='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.css' rel='stylesheet' />



<!--
    <link rel='stylesheet' href='https://api.tiles.mapbox.com/mapbox.js/v1.6.4/mapbox.css'  />
-->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="css/style1.css">

</head>
<body>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=174160066065207&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">

            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    
                </button>
                <a class="navbar-brand" href="#"> On-Demand High-Capacity Ride-Sharing</a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><div class = "about">About</div></li>
                    <li><div class = "attribution">Attribution</div></li>
                   
                    
                </ul>
            </div><!--/.nav-collapse -->



        </div>
    </div>
 
    <div id = "map">
    <script>
     L.mapbox.accessToken = 'pk.eyJ1IjoiZGhlY2h0IiwiYSI6ImNqNHRueTVyeDA3ZmYyd3FuY2NmYW9tNmoifQ.FetU2-IBDcrhTmSKBpFIfA';
     var map = L.mapbox.map('map', 'mapbox.streets')
      .setView([40.758896, -73.985130], 13);
     </script>
     
     <script>
      L.mapbox.accessToken = 'pk.eyJ1IjoiZGhlY2h0IiwiYSI6ImNqNHRueTVyeDA3ZmYyd3FuY2NmYW9tNmoifQ.FetU2-IBDcrhTmSKBpFIfA';
      var imageUrl = '/Users/dhecht/Desktop/sim.png',
    // This is the trickiest part - you'll need accurate coordinates for the
    // corners of the image. You can find and create appropriate values at
    // http://maps.nypl.org/warper/ or
    // http://www.georeferencer.org/
      imageBounds = L.latLngBounds([
        [40.6994, -73.9064],
        [40.8782, -74.0190]]);

      var map = L.mapbox.map('map', 'mapbox.streets')
        .fitBounds(imageBounds);

     // See full documentation for the ImageOverlay type:
     // http://leafletjs.com/reference.html#imageoverlay
      var overlay = L.imageOverlay(imageUrl, imageBounds)
       .addTo(map);
     </script>
     
     <style>
     .menu-ui {
       background:#fff;
       position:absolute;
       top:10px;right:15px;
       z-index:1;
       border-radius:3px;
       width:120px;
       border:1px solid rgba(0,0,0,0.4);
       }
       .menu-ui a {
         font-size:13px;
         color:#404040;
         display:block;
         margin:0;padding:0;
         padding:10px;
         text-decoration:none;
         border-bottom:1px solid rgba(0,0,0,0.25);
         text-align:center;
         }
         .menu-ui a:first-child {
           border-radius:3px 3px 0 0;
           }
         .menu-ui a:last-child {
           border:none;
           border-radius:0 0 3px 3px;
           }
         .menu-ui a:hover {
           background:#f8f8f8;
           color:#404040;
           }
         .menu-ui a.active {
           background:#601918;
           color:#FFF;
           }
           .menu-ui a.active:hover {
             background:#917475;
             }
     </style>
     <nav id='menu-ui' class='menu-ui'></nav>
     <div id='map'></div>

     <script>
     L.mapbox.accessToken = 'pk.eyJ1IjoiZGhlY2h0IiwiYSI6ImNqNHRueTVyeDA3ZmYyd3FuY2NmYW9tNmoifQ.FetU2-IBDcrhTmSKBpFIfA';
     var layers = document.getElementById('menu-ui');

     addLayer(L.mapbox.tileLayer('mapbox.streets'), 'Base Map', 1);
     addLayer(L.mapbox.tileLayer('mapbox.oneway'), 'High-Demand Areas', 2);
     addLayer(L.mapbox.tileLayer('mapbox.rail-metro'), 'Public Transport Stations', 3);
     

     function addLayer(layer, name, zIndex) {
         layer
             .setZIndex(zIndex)
             .addTo(map);

         // Create a simple layer switcher that
         // toggles layers on and off.
         var link = document.createElement('a');
             link.href = '#';
             link.className = 'active';
             link.innerHTML = name;

         link.onclick = function(e) {
             e.preventDefault();
             e.stopPropagation();

             if (map.hasLayer(layer)) {
                 map.removeLayer(layer);
                 this.className = '';
             } else {
                 map.addLayer(layer);
                 this.className = 'active';
             }
         };

         layers.appendChild(link);
     }
     </script>

     
 </div>

    <div class="container overlay">
        <div class="jumbotron">
            <h2>On-Demand High-Capacity Ride-Sharing</h2>
            <p> For the first time, we quantify experimentally the trade-off between fleet size, capacity, waiting time, travel delay, 
                and operational costs for low to medium capacity vehicles, such as taxis and van shuttles. The algorithm used to produce this visualization is validated with 
                approximately 3 million rides extracted from the New York City taxicab public dataset. Our experimental study considers 
                ride sharing with rider capacity of up to ten simultaneous passengers per vehicle. The algorithm applies to fleets of autonomous 
                vehicles and also incorporates  rebalancing  of  idling  vehicles  to  areas  of  high  demand.  This  framework  is  general  
                and  can  be  used for many real-time multi-vehicle, multi-task assignment problems.</p>
            <br/>
          
            <!--
            <p class = 'text-center'><a id = "begin" class="btn btn-primary btn-lg active" role="button">Enter</a></p>
           -->

            <button onclick="overlay.close()">Load Data</button>
            
            <br/>
            <br/>
            <p style = 'font-size:15px'>This visualzation was produced with the help of <a href = "http://www.mapbox.com">Mapbox</a>, <a href = "http://www.heroku.com">Heroku</a>, and Chris Whong's <a href = "https://github.com/chriswhong/nyctaxi">Github Repo NYC Taxis: A Day in the Life </a>. </p>
            <p style = 'font-size:15px'> For more information about the algorithm, you can refer to our <a href = "http://www.dcsc.tudelft.nl/~jalonsomora/docs/17-alonsomora-ridesharing-pnas.pdf">PNAS Article</a> and our full <a href = "http://www.dcsc.tudelft.nl/~jalonsomora/docs/17-alonsomora-ridesharing-pnas-supplemental.pdf">Publication</a>. </p>
           
        </div>
    </div>


    <div class = 'container popup aboutPopup'>
        <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title">About</h3><span class="glyphicon glyphicon-remove"></span>
      </div>
      <div class="panel-body">
      <strong><p>A Ride-Sharing Visualization </p></strong>
          <h5> Based on <strong><a href = "http://www.dcsc.tudelft.nl/~jalonsomora/docs/17-alonsomora-ridesharing-pnas-supplemental.pdf">On-demand high-capacity ride-sharing via dynamic trip-vehicle assignment</a></strong> 
              by Javier Alonso-Mora, Samitha Samaranayake, Alex Wallar, Emilio Frazzoli and Daniela Rus.
          </h5>

        <p> Ride-sharing services are transforming urban mobility by providing timely and convenient transportation to anybody, anywhere,
        and anytime. These services present enormous potential for positive societal impacts with respect to pollution, energy consumption, 
        congestion, etc. Current mathematical models, however, do not fully address the potential of ride-sharing. Recently, a large-scale 
        study highlighted some of the benefits of car pooling but was limited to static routes with two riders per vehicle (optimally) or three (with heuristics). 
        We present a more general mathematical model for real-time high-capacity ride-sharing that (i) scales to large numbers of passengers and trips and 
        (ii) dynamically generates optimal routes with respect to online demand and vehicle locations. The algorithm starts from a greedy assignment and improves 
        it through a constrained optimization, quickly returning solutions of good quality and converging to the optimal assignment over time. We quantify 
        experimentally the trade-off between fleet size, capacity, waiting time, travel delay, and operational costs for low- to medium-capacity vehicles, such as
        taxis and van shuttles. 
         </p>
         <p> 
          The algorithm is validated with âˆ¼3 million rides extracted from the New York City taxicab public dataset. Our experimental study considers ride-sharing 
          with rider capacity of up to 10 simultaneous passengers per vehicle. The algorithm applies to fleets of autonomous vehicles and also incorporates
          rebalancing of idling vehicles to areas of high demand. This framework is general and can be used for many real-time multivehicle,
          multitask assignment problems.
       
        </p>
        <p><a href = "https://github.com/dannyhecht/MOD-ride-sharing">Code on Github </a></p>
        
         <br/>
         <br/>
       

      </div>
    </div>
    </div>
   
    <div class = 'container popup attributionPopup'>
        <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title">Attribution</h3><span class="glyphicon glyphicon-remove"></span>
      </div>
      <div class="panel-body">

        <ul>
            <li><a href = "http://bost.ocks.org/mike/leaflet/">Mike Bostock's D3 + Leaflet</a> - The foundation for throwing geoJSON onto Leaflet with external tiles.
            </li>
            <li><a href = "http://bl.ocks.org/KoGor/8163022">KoGor's Marker Animation Along SVG Path</a> - This technique made the animated cab marker work!
            </li>
            <li>
            <a href = "http://www.mapbox.com">Mapbox</a> for super-simple subdued basemap tiles, and for releasing a totally sweet node package for converting Google Encoded Polylines into raw Coordinates.
            </li>
            <li>
            Thanks to <a href = "https://github.com/chriswhong/nyctaxi">u/fhoffa Chris Whong </a> and his Github Repo NYC Taxis: A Day in the Life, for helping me get started on producing this visualization.
            </li>

            
        </ul>
      </div>
    </div>
    </div>
    <div class="dateTimeBox box">
        <div class = "date"></div> 
        <div class = "time"> <span class="glyphicon glyphicon-time"></span> <span class = "readableTime"></span></div> 
        <div class= "controls">
            <button type="button" class="btn btn-default btn-xs slower"><span class="glyphicon glyphicon-backward"></span> Slower</button>
            <button type="button" class="btn btn-default btn-xs faster">Faster <span class="glyphicon glyphicon-forward"></span> </button>   
        </div>
        <div>Time Factor: <span class = "timeFactor"></span> minutes per second</div>
    </div>
    <div class="legendBox box">
        <div class = "boxHeader"> Legend</div>
        <div class = 'legendItem'>
        <svg>
            <circle r="5" id="rebalancing" transform="translate(20,20)"></circle>
        </svg><p>Non-Empty Taxi</p></div>
        <div class = 'legendItem'>
        <svg>
            <circle r="20" id="rebalancing" transform="translate(20,20)" style="opacity:0.30000000000000004"></circle>
        </svg><p>Rebalancing Taxi<sup>*</sup></p></div>
        <div class = 'legendItem'>
        <svg>
            <div r = "5" class="star" transform="translate(20,20)"></div>
        </svg><p>Request</p></div>
        <div class = 'legendItem'>
        <svg>
            <div r="5" class="triangle" transform="translate(20,20)"></div>
        </svg><p>Drop Off</p></div>
        <div class = 'legendItem'>
        <svg>
            <path class="trip true" style="opacity:.7" d="M10,10L30,30" ></path>
        </svg><p>Trip Route<sup>*</sup></p></div>
    </div>

    <div class="newBox box">
     <button type="button" class="btn btn-default btn-lg reload">
      <span class="glyphicon glyphicon-refresh"></span> Load Another Day
    </button>
    </div>
    <!--$: <span class = "runningFare">Test</span>-->

    <div class="totalsBox box">
        <div class = "boxHeader"> Results</div>

        <p>Service Rate: <span class = "runningService running"></span></p>
        <p>Waiting Time (s): <span class = "runningWaiting running"></span></p>
        <p>In-Car Delay Time (s): <span class = "runningDelay running"></span></p>
        <p>Occupancy: <span class = "runningPassengers running"></span></p>
        <p> Travel Distance (km): <span class = "runningDistance running"></p>
        <div class = "passengerGlyphs"></div>
    </div>  


    <div class="areaChartBox box">
    </div>



    <script src="js/moment.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://d3js.org/d3.v4.min.js"></script>
    <script src='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.js'></script>
 <!--
    <script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.4/mapbox.js'></script>
-->
    <script src="js/vars.js"></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-4921346-5', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
